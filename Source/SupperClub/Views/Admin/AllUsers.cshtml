@model SupperClub.Models.AllUsersModel

@{
    ViewBag.Title = "All Users";
}

@section PageSpecificScripts {
<script type="text/javascript">
    function LockUser(userId, rowId) {
        $.getJSON('@Url.Action("LockUser", "Admin")', { userId: userId }, function (newState) {
            if (newState == null) {
                alert("There was a problem (un)locking this user, please try again");
            }
            else {
                $("#locked_" + rowId).text(newState);
            }
        });
    }
</script>
}

<!--  Page Title -->
<div class="container pattern-design2">
    <div class="container">
        <p>@HttpContext.Current.Request.RequestContext.RouteData.Values["controller"].ToString() / @ViewBag.Title</p>
    </div>	
</div>
<!-- Page Title End -->

@if (ViewBag.Notification != null || TempData["Notification"] != null)
{
    SupperClub.Models.NotificationModel nModel = (ViewBag.Notification == null) ? (SupperClub.Models.NotificationModel)TempData["Notification"] : (SupperClub.Models.NotificationModel)ViewBag.Notification;
    TempData["Notification"] = null;
    @Html.Partial("_Notification", nModel);
}
@if (ViewBag.HideMainContainer == null || ViewBag.HideMainContainer == false)
{
    <div class="container">
        <div class="sixteen columns">
            <h4 class="headline">User Table</h4>
                <table class="standard-table">
				<tr>
					<!--<th>Unique Id</th>-->
					<th>Email</th>
                    <th>Name</th>
                    <th>DOB</th>
                    <th>Gender</th>
					<th>Events Booked</th>
                    <th>Ranking</th>
					<th>Locked Out</th>
				</tr>
                
                @for(int i = 0 ; i <= Model.AllUsers.Count - 1 ; i++)
                {
                    SupperClub.Domain.User u = Model.AllUsers[i];
                    <tr>
					    <!--<td>@u.Id</td>-->
                        <td>@u.Email</td>
					    <td>@(u.FirstName + " " + u.LastName)</td>
					    <td>@if(u.DateOfBirth.HasValue){@u.DateOfBirth.Value.ToShortDateString()}</td>
                        <td>@u.Gender</td>
                        <td>@u.EventAttendees.Count.ToString()</td>
                        <td>
                            <i class="icon-thumbs-up"></i><span class="positive">@u.PositiveRanking.ToString()</span>
                            @Html.Raw(" | ")
                            <i class="icon-thumbs-down"></i><span class="negative">@u.NegativeRanking.ToString()</span>
                        </td>
					    <td><a href="#" id="@("locked_" + i.ToString())" onclick="LockUser('@u.Id', @i);">@u.Locked.ToString().ToLower()</a></td>
				    </tr>
  				}
            </table>
        </div>
    </div>
}