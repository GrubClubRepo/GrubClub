


@{
    ViewBag.Title = "Add Profile to Tag";
}
<script type="text/javascript">
    var SupperClubId;
    $(document).ready(function () {

        $("#SupperClubDL").change(function () {

            var selectedTag = parseInt($("#SupperClubDL option:selected").val());
            SupperClubId = selectedTag;
            debugger;
            $("#Id").val(selectedTag);
            if (selectedTag > 0) {
              
                ClearTags();
                $.ajax({

                    url: '@Url.Action("GetSupperClubTag", "Admin")',
                    type: "GET",
                    data: { supperClubId: selectedTag },
                    success: function (tags) {
                        debugger;
                        
                        $("#supperclubList").val(tags.tags);
                        if (tags.tags != null && tags.tags != "") {

                            tags.tags = tags.tags.toString().substring(0, tags.tags.length - 1);
                            var tagList = tags.tags.split(",");


                            $("#TagsDL").val(tagList);
                            $("#TagsDL").trigger('change');

                            $("#TagsDL").trigger('chosen:updated');
                        }
                    },
                    error: function () {
                        alert("Failed to get profile tag details.");
                    }
                });
            }
        });

        function ClearTags()
        {
            $("#TagsDL").each(function () {

                $(this).removeAttr("selected");
            });
            var list = "";
            $("#TagsDL").val(list);
            $("#TagsDL").trigger('change');

            $("#TagsDL").trigger('chosen:updated');
            $('option:selected', '#TagsDL').removeAttr('selected');
        }

        function ClearSupperClubs()
        {
            $("#SupperClubDL").each(function () {

                $(this).removeAttr("selected");
            });
            var list = "";
            $("#SupperClubDL").val(list);
            $("#SupperClubDL").trigger('change');

            $("#SupperClubDL").trigger('chosen:updated');
            $('option:selected', '#SupperClubDL').removeAttr('selected');
        }
        $("#TagsDL").change(function () {
            var tagsText = "";
            var cnt = $("#TagsDL option:selected").length;

            for (i = 0; i < cnt; i++) {
                tagsText = tagsText + ", " + $("#TagsDL option:selected")[i].value;
            }

            $("#supperclubList").val(tagsText);

        });

        $('#btnSubmit').click(function () {

            var supperClub = SupperClubId;
            var profileTags = $("#supperclubList").val();
            $.ajax({
                type: 'POST',
                // this url needs to be changed accordingly to the right URL - whatever the controller/routing expects
                url: '@Url.Action("AddSupperClubTag", "Admin")',
                data: { supperClubId: SupperClubId, profileTags: profileTags },
                //  data: { email: email, friends:lstfriends  },
                cache: false,
                dataType: 'json text',
                traditional: true,
                success: function (result) {

                    if (result == "true") {

                        alert('Tags Added Succesfully');
                    }
                    ClearTags();
                    ClearSupperClubs();


                },
                error: function (result) {

                    alert('Sorry, there was an error submitting when adding tags!');
                }
            });

        });

    });

</script>
<link rel="stylesheet" type="text/css" href="@Url.Content("~/Content/css/multi-select.css")">
<script src="@Url.Content("~/Scripts/jquery.multi-select.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
@*This script handles additional custom date validation on dd/MM/yy*@
<script src="@Url.Content("~/Scripts/jquery.validate.custom.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/ww.jquery.min.js")" type="text/javascript"></script>
<div class="container pattern-design2">
    <div class="container">
        <p>@HttpContext.Current.Request.RequestContext.RouteData.Values["controller"].ToString() / @ViewBag.Title</p>
    </div>
</div>
<!-- Page Title End -->
@if (ViewBag.Notification != null || TempData["Notification"] != null)
{
    SupperClub.Models.NotificationModel nModel = (ViewBag.Notification == null) ? (SupperClub.Models.NotificationModel)TempData["Notification"] : (SupperClub.Models.NotificationModel)ViewBag.Notification;
    TempData["Notification"] = null;
    @Html.Partial("_Notification", nModel);
}
<div class="container" id="MainContainer"  style="margin-top:10px;">
    <div class="sixteen columns">
        
        @using (Html.BeginForm("SupperClubTag", "Admin", FormMethod.Post, new { id = "TagForm", enctype = "multipart/form-data" }))
        {
            <div class="field">
                @Html.DropDownList("SupperClubDL", (SelectList)ViewBag.SupperClubs, "- Select SupperClub -", new { @class = "chosen-select full-width mb" })
            </div>

     
      
              <select data-placeholder="Add a tag..." multiple class="chosen-select full-width mb " id="TagsDL">
                        @if  (ViewBag.Tags != null)
                        { 
                        foreach (SupperClub.Domain.ProfileTag t in ViewBag.Tags)
                        {
                           
                                <option value="@t.Id">@t.Name</option>
                          
                        }
                        }
                    </select>
            
             <input type="text" id="supperclubList" style="display:none;" />
            
            <input type="button" id="btnSubmit" value="Update Tag" class="button small green" />
        }
    </div>
</div>